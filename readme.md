# 本文件旨在說明一個 個人餐廳紀錄手機應用 的設計。

解決的問題：民眾常為用餐選擇煩惱。如果能夠以使用者所在地為中心，列出吃過的全部店家。使用者看著自己的餐廳口袋地圖，就有機會想到可以在哪裡聚會。
根據我的訪問，有人想透過記錄餐廳地圖，想起還有這個選項可以吃；有人則想避免自己又吃到不喜歡的餐廳。

運作方式：
1.使用者能夠記錄自己吃過的餐廳。 
2.以使用者地點為中心，列出自己的餐廳紀錄。
點 notes 可以看到詳細資訊 透過 (Maps Embed API 裡的搜尋 + 資料卡)

競品分析：市面上的其他軟體聚焦在，發文分享「給別人」自己吃過的東西、「別人給自己」推薦想吃甚麼（廠家置入廣告變現）。 市場上缺少一個 「給自己」的餐廳記錄。

Q ：我為甚麼不用 google map 的「儲存」功能就好？ 在我已經使用習慣的軟體上按一個按鈕就行。　
Ａ：地圖有太多額外地理資訊，在瀏覽清單選擇餐廳時不直觀，並且它也缺少了很多方便的功能。 

「讓這個軟體儲存餐廳變得像使用 google map 一樣簡單無痛，但加上更多的方便功能 (AI分類、filter)，是這個軟體的目標。」　

______________________________________________
# mvp 架構總覽 (High-Level Architecture)

![alt text](<memo restaurant.png>)

______________________________________________

# 應用功能分析

功能性需求 (Functional Requirements)：系統必須做什麼？
新增資料：
搜尋餐廳 透過server的 map api 取得 place id （ 連網 ） 
為某家餐廳餐點撰寫 memo 紀錄。 儲存

### 檢視資料: 

離線瀏覽已存餐廳的紀錄 ( filter by distance and cuisine 餐廳名稱 )
決定要去哪家餐廳時，看 notes，點開 notes 的地圖icon按鈕 可以透過字串拼湊出 deep link，打開 google map 跳轉到那家餐廳。 ( 不耗 api 額度) 

另外也還有編輯按鈕跟刪除按鈕 
(pending)  剛新增完一個筆記 點”新增成功”的反饋，能夠跳轉到那則筆記。(放在檢視頁面置頂 ， 最近新增過筆記 欄位 )

### 編輯 刪除資料
 離線瀏覽已存餐廳的紀錄時，除了filter 額外還有一個編輯按鈕。 點進去之後會依照新增筆記的日期排序， 並且也還有餐廳名稱的 search bar 可以當作 filter 
方便定位自己寫的紀錄，做到編輯 刪除 

非功能性需求 ：

可用性: 三步以內要能做到核心功能。 包含 新增 notes、檢視 notes
可靠性：自動儲存打到一半的 notes 
______________________________________________
# Tech stack

Frontend (UI 層): React Native (TypeScript)
State Management: React Query。 不用 Redux Toolkit ，因為狀態不多
Backend / API 層: Node.js (Express RESTapi) 因為使用者需要的請求固定、單純。所以先不使用 nest.js
Database: SQLite(local)、 postgresql (aws)
External Service: Google Maps Places API
用 Repository Pattern，因為未來要把本地資料庫同步到雲端（ NotesRepository.ts 包 SQLite CRUD）


______________________________________________
# 哪些是潛在瓶頸？
A: map api 額度。 在效能撐不住之前，額度會先用完。

伺服器流量估計：

同主題的 app 有十萬下載量。以活躍人數 1/10 做計算。假設每天活躍人數為一萬。
每人每天使用伺服器功能午餐晚餐兩次 。每次使用大概呼叫4次 api。總query次數 80000。 ( 一餐新增一個 notes 算一次。  )
平均  QPS 80000/86400 小於一，低負擔。
峰值 QPS  ：人流集中在午餐後晚餐後。假設 40000 呼叫集中在午餐的兩小時。 峰值 QPS 是 5.2。
伺服器要處理每日八萬流量，每一流量只實現一個功能，就是幫使用者呼叫 google map api

瓶頸分析
呼叫 api 對 cpu 的消耗是要把資料轉成 json 去發 request ，還有解析對方發回來的結果。沒有甚麼邏輯運算，cpu 消耗低。
呼叫 api 對記憶體的消耗是，暫存使用者的請求和 google 回傳的結果（每份最多幾十 kb ） 同時有 5 人查詢，記憶體壓力只有不到 1mb（1mb = 1024kb）。而最低階伺服器記憶體也有 512 mb
呼叫 api 對網路頻寬的消耗則是發請求給 google 然後下載它的回應。假設每個50 kb，QPS 5，那是 0.25 mb / s。低階伺服器能跑大概 12.5 mb/s 。 所以網路也不是瓶頸。
整體效能負擔很低，所以伺服器選用 aws lambda ，運用它的免費額度即可度過前期，並且也方便之後規模的擴張。



______________________________________________

# 未來演進 (Future Work)

把顯示 notes 的地方支援用地圖的方式顯示，能顯示餐點照片、菜單之類的。 現在就只是單純列出 notes。 


行銷宣傳：在代言氾濫的時代，有太多廣告後產品翻車的事件。大家不再相信名人生硬的推薦臺詞，而是更相信自己所時常觀看，建立信賴與熟悉的小網紅。
所以與其找一個大網紅念臺詞，不如找多個小網紅低價置入，請它們以自然的方式帶出應用。 比如吃完飯後很普通的拍到網紅在打記錄即可。

也可考慮 google map 評論文字廣告。 這是我現有的很大資源。

後續擴充與變現管道： 
社交影響力：建立曝光管道吸引創作者與餐廳 => 可上傳自己的記錄，如果有別的使用者對同一餐廳同一道菜有評論。它可以透過比較兩者對同一料理的想法，來決定要不要 「追蹤」它。 追蹤後可以看到創作者的更多餐廳記錄，作為自己用餐選擇的參考依據。
視覺化顯示口袋名單： 在地圖上展示所有去過的餐廳。就像勳章一樣呈現出來，讓使用者想要發文分享自己的專屬探索記錄。亦可以配合成就系統，比如在一個地區記錄足夠多的店家後，獲得 「中正區美食家」等徽章。
探索頁面： 透過 AI 自然語言處理使用者們的評論，去配對用餐習慣相似的人，推薦餐廳。 並且在這個頁面提供餐廳們置入。
